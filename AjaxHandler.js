function AjaxObj(){    // Non MS browser's have a build in ajax class    if (window.XMLHttpRequest)    {        return new XMLHttpRequest();    }    else    {        // UPS no ajax class this could be a MS check for ActiveX        if (window.ActiveXObject)        {            return new ActiveXObject("Microsoft.XMLHTTP");        }        else        {            return;        }    }}/** *  * @param path *            the url path * @param data *            the content to be posted * @param handler *            the Object to receive reply (has to contain the Method *            parseResponse(xmlObj)) */function AjaxHandler(path, data, handler){    xmlObj = AjaxObj();    xmlObj.onreadystatechange = function()    {        if (xmlObj.readyState == 4)        {            if (xmlObj.status == 200)            {                try                {                    handler.parseResponse(xmlObj);                }                catch (e)                {                    var fail = e;                    var etext = xmlObj.responseText;                    fail = fail;                }            }        }    };    if (data != null)    {        xmlObj.open('post', path, 'true');        xmlObj.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");    }    else    {        xmlObj.open('get', path, 'true');    }    xmlObj.send(data);}